# AI赋能职教视频个性化教学项目需求规格说明书（第四稿-详细版）

## 文档版本信息
- **版本号**: v4.0
- **编写日期**: 2024年
- **编写团队**: 周东吴（组长）、成怡、杨雅娟、张亚鹏、雷宇
- **技术顾问**: 蒋国伟
- **指导老师**: 王海霞
- **文档状态**: 待评审

---

## 目录
1. [项目概述](#1-项目概述)
2. [目标用户与使用场景](#2-目标用户与使用场景)
3. [核心功能模块详细设计](#3-核心功能模块详细设计)
4. [系统架构与技术方案](#4-系统架构与技术方案)
5. [数据模型设计](#5-数据模型设计)
6. [接口设计](#6-接口设计)
7. [用户界面设计](#7-用户界面设计)
8. [非功能性需求](#8-非功能性需求)
9. [测试与验收标准](#9-测试与验收标准)
10. [项目里程碑与任务规划](#10-项目里程碑与任务规划)
11. [风险与对策](#11-风险与对策)
12. [附录](#12-附录)

---

# 1. 项目概述

## 1.1 项目一句话描述

构建一个**以主动智能补偿为核心**的教学视频个性化学习支持系统，通过多模态分析学习者的观看行为，**自动识别知识薄弱点并主动推送高质量补偿资源**，实现真正意义上的"一人一策"个性化教学。

## 1.2 项目背景

本项目是在蒋国伟团队前期"教学视频解析"成果基础上，进行深度的功能进阶与目标重构。项目聚焦职业教育领域，旨在解决以下核心痛点：

- **学生被动看视频**：学习者大量依赖教学视频自学，但普遍缺乏针对性反馈
- **知识吸收效率低**：学习过程中常见行为包括暂停、回放、拖拽返回、长时间停留等，这些行为往往对应"知识点未掌握/理解困难"，但传统教学难以实时捕捉
- **学习路径一刀切**：传统平台"千人一面"，无法提供主动、精准、即时的补偿
- **教师负担重**：教师无法实时掌握每位学生的具体卡点，学情监测成本高

## 1.3 核心愿景

- **懂学生的AI**：打造"教育版淘宝"的千人千面推荐能力，实现学习内容与路径的个性化匹配
- **角色转变**：推动学生从"被动接收者"转变为"项目设计者/参与者"，增强学习主动性与创造力
- **动态干预**：让AI从单纯的视频播放器，升级为能实时捕捉学习障碍、提供"补偿教育"的智能导师

## 1.4 项目目标（优先级排序）

1. **主动智能补偿**（最高优先级）
   - 系统必须在学习者"卡住"时**主动干预**，而非等他求助
   - 响应时间：行为检测 → 补偿推送 ≤ 3-5分钟

2. **精准识别学习者的真实薄弱点**
   - 区分"走神"与"深度思考/理解困难"
   - 难点识别准确率目标：≥ 85%（v1.0）

3. **自动生成高质量、短小精悍的补偿性资源**
   - 补偿资源时长控制在8分钟以内
   - 必须"**短、狠、准**"，直击痛点

4. **形成自适应闭环学习路径**
   - 根据学习反馈动态调整路径
   - 实现"一人一策"的个性化学习

## 1.5 项目边界（本期不做/暂缓）

- ❌ 不做泛娱乐平台视频理解与推荐
- ❌ 不做完整LMS/教务系统替代，仅做"视频学习辅助闭环"
- ❌ 不追求全学科通用，优先聚焦一个课程/一类视频形态跑通闭环
- ❌ 不以"最强模型"作为指标，优先可用、可验证、可迭代
- ❌ 不做完整的用户注册登录系统（初期可简化）
- ❌ 不做移动端APP（优先Web端）

---

# 2. 目标用户与使用场景

## 2.1 用户角色

### 2.1.1 学生（主要用户）
- **角色描述**：职业教育、中职、高职、应用型本科学生（知识类课程）
- **核心需求**：
  - 观看教学视频
  - 接收智能补偿资源
  - 完成诊断练习
  - 获得个性化学习路径建议
  - 查看个人学习进度与薄弱点分析

### 2.1.2 教师/教研（次要用户）
- **角色描述**：任课教师、教研人员
- **核心需求**：
  - 上传教学视频
  - 查看班级共性难点、学情热力点
  - 查看补偿资源使用量与效果
  - 审核/编辑AI生成的知识点与资源
  - 优化教学设计与策略

### 2.1.3 项目管理员（可选）
- **角色描述**：系统管理员、课程维护人员
- **核心需求**：
  - 课程/视频/资源维护
  - 策略阈值配置（T1/T2/T3等）
  - 用户权限管理
  - 系统监控与日志查看

## 2.2 核心使用场景（用户故事）

### 场景1：学生观看视频遇到难点
**用户故事**：学生观看《数据库-SELECT查询》视频，在"多表连接"知识点处反复回放3次，停留时长超过该片段平均时长的3倍。

**系统行为**：
1. 系统实时检测到异常行为
2. 判定"多表连接"为疑难点（触发原因：回放3次、停留时长异常）
3. 在5分钟内主动推送补偿资源：
   - 5分钟精讲微视频（针对多表连接的原理与语法）
   - 3题诊断练习（选择题+填空题，带详细解析）
   - 知识卡片（多表连接的关键步骤与注意事项）

**学生反馈**：
- 完成练习，正确率≥80% → 系统标记"已掌握"，减少后续推送频率
- 完成练习，正确率<80% → 系统升级干预，推送更详细的例题讲解

### 场景2：学生完成补偿后继续学习
**用户故事**：学生完成"多表连接"的补偿资源学习，练习正确率达到85%。

**系统行为**：
1. 更新该知识点状态：疑难 → 已掌握
2. 降低该知识点在后续学习路径中的权重
3. 跳过重复补偿，继续推荐下一知识点
4. 更新个人学习路径，显示当前进度与下一步建议

### 场景3：教师查看班级学情
**用户故事**：教师登录系统，查看《数据库-SELECT查询》课程的班级学情。

**系统展示**：
1. **班级疑难知识点排行**：
   - K3"多表连接"：被15名学生标记为疑难，平均回放4.2次
   - K7"子查询"：被12名学生标记为疑难，平均回放3.8次
2. **学情热力图**：
   - 每个知识点的"回放热力/暂停热力"可视化展示
   - 时间轴上的行为密度分布
3. **补偿资源效果概览**：
   - 补偿资源使用量：知识卡片120次，练习题85次，微视频45次
   - 补偿后掌握率提升：从45%提升至78%

**教师行动**：
- 根据数据优化"多表连接"知识点的讲解方式
- 补充更多针对性的教学资源

### 场景4：考前复习场景
**用户故事**：学期末，学生需要复习全学期的学习内容。

**系统行为**：
1. 根据学生全学期的观看行为轨迹，自动生成"个人错难点集锦"
2. 生成短视频列表，包含所有标记为"个体弱项"的知识点片段
3. 按薄弱程度排序，优先推荐最需要复习的知识点
4. 提供复习路径建议，支持一键生成复习计划

---

# 3. 核心功能模块详细设计

## 3.1 模块A：视频多模态语义解析与知识建模（基石）

### 3.1.1 模块目标
把视频内容结构化到"知识点-时间段-关键词-资源"层面，为后续的个性化推荐提供准确的内容语义基础。

### 3.1.2 输入
- **教学视频文件/链接**（优先：录屏+讲解/PPT类型）
- **可选辅助材料**：
  - 原始字幕文件（SRT/VTT格式）
  - PPT文件（PPTX格式）
  - 讲义文本（TXT/DOCX格式）
  - 课程大纲/知识点列表

### 3.1.3 处理流程

#### A3.1 多源特征提取

**1. 音频处理（ASR）**
- **功能**：将教师讲解语音转为文本
- **输出**：带时间戳的转写文本
- **技术要求**：
  - 支持中文语音识别
  - 识别准确率 ≥ 90%
  - 支持方言与行业术语适配（可导入自定义词表）
  - 识别语音中的重音、停顿等强调性特征
  - 支持教师一键修正识别错误

**2. 视觉处理（CV/OCR）**
- **功能**：识别教学视频中的视觉信息
- **识别内容**：
  - PPT文字内容
  - 黑板板书
  - 实验演示关键动作
  - 图表、公式、代码片段
- **技术要求**：
  - OCR识别准确率 ≥ 85%
  - 支持中英文混合识别
  - 对模糊画面进行图像增强预处理
  - 自动检测视频清晰度、音量稳定性等质量问题

**3. 文本处理**
- **功能**：解析视频字幕、标题、描述等元数据
- **处理内容**：
  - 提取核心知识点
  - 识别关键术语
  - 分析文本语义结构

#### A3.2 知识点切分与标注

**输出格式**：知识点列表 K = {K1, K2, ..., Kn}

**每个知识点Ki包含**：
- **基本信息**：
  - 知识点ID（唯一标识）
  - 知识点名称（可自动生成+人工可编辑）
  - 所属视频ID
  - 起止时间段（start_time, end_time，精确到秒）
- **语义信息**：
  - 关键词列表（top N，如10-20个）
  - 简要摘要（1-3句话，自动生成）
  - 知识点类型（概念/技能步骤/例题/实操等）
  - 难度等级（基础/进阶/拓展，可自动标注+人工调整）
- **关联信息**：
  - 前置知识点列表（依赖关系）
  - 后置知识点列表
  - 重要程度评分（1-5分）

**知识点粒度要求**：
- **细粒度知识点**（强烈建议）
  - 例如："GROUP BY 执行顺序"、"WHERE与HAVING区别"、"多表连接的语法结构"
  - 而非粗粒度章节（如"SELECT查询基础"）
- **数量要求**：对选定课程样例视频，能生成不少于10-30个知识点切片

#### A3.3 知识图谱构建（初版可弱化）

**基础要求**：
- 至少支持"顺序关系"（知识点在视频中的先后顺序）
- 支持知识点间的层级关系（父子节点）

**进阶要求**（v2.0）：
- 构建完整的知识依赖图谱
- 自动计算知识点间的关联度
- 支持知识点的前置/后置依赖关系
- 为"先修知识不足"提供预警

#### A3.4 职教专属功能

**1. 职教专属术语库构建**
- 针对数控、汽修、护理等细分领域，建立行业专属术语库
- 提升ASR/CV识别准确率
- 支持教师手动补充术语并迭代优化

**2. 实操动作规范性校验**
- 对实验、操作类视频，通过CV技术识别关键动作规范性
- 与标准动作库比对并标记偏差点
- 为补偿资源生成提供依据

**3. 实操场景安全风险识别**
- 针对焊接、电工等高风险场景，识别安全违规行为（如未戴防护用具）
- 生成安全警示标签，优先触发安全类补偿资源

**4. 视频内容去娱乐化过滤**
- 自动识别并过滤与职教无关的娱乐化片段（闲聊、广告）
- 对非核心教学内容（点名、设备调试）智能分段
- 支持学生快速跳过

### 3.1.4 输出
- 结构化知识图谱JSON文件
- 知识点-时间戳索引表
- 知识点关系图（可视化）

### 3.1.5 验收标准
- ✅ 对选定课程样例视频，能生成不少于N个知识点切片（N由课程确定，如10-30）
- ✅ 每个知识点均具备可回放定位的时间戳
- ✅ 知识点识别准确率 ≥ 85%（v1.0）
- ✅ 支持人工在管理端调整知识点边界与名称（保证可控性）
- ✅ 知识点名称、摘要、关键词可人工编辑

---

## 3.2 模块B：学习行为采集与难点识别

### 3.2.1 模块目标
通过观看行为推断"可能不懂的知识点"，精准识别学习者的真实薄弱点。

### 3.2.2 行为数据采集（MVP必须）

#### B2.1 基础行为事件
系统实时记录以下行为事件（带时间戳）：

| 事件类型 | 描述 | 采集字段 |
|---------|------|---------|
| **play** | 开始播放 | video_id, timestamp, play_position |
| **pause** | 暂停播放 | video_id, timestamp, pause_position, pause_duration |
| **seek** | 拖拽进度条 | video_id, timestamp, from_position, to_position |
| **rate_change** | 改变播放速度 | video_id, timestamp, old_rate, new_rate |
| **ended** | 播放结束 | video_id, timestamp, total_duration |
| **leave** | 中途退出 | video_id, timestamp, leave_position, watch_duration |

#### B2.2 高级行为指标
基于基础事件计算的高级指标：

- **回放次数**：某时间段重复进入的次数
- **停留时长**：在某知识点区间停留总时长
- **暂停频率**：单位时间内的暂停次数
- **拖拽回放频率**：向后拖拽的次数
- **快进/跳过行为**：向前跳过的片段（反向信号，可能表示已掌握）

#### B2.3 学习状态感知（可选扩展）

**间接行为指标**：
- 打字速度（如在笔记区）
- 拖拽频率
- 页面停留时长
- 鼠标移动轨迹（可选）

**情绪感知**（可选，需用户授权）：
- 接入摄像头进行微表情分析
- 判断"走神/困惑/专注"状态

### 3.2.3 难点判定策略

#### B3.1 规则策略（初版要求"可解释"）

对每个知识点Ki计算困难度分数Di，至少支持以下规则（后续可替换为ML模型）：

**触发条件**（满足任一或组合即触发"疑难点"）：

| 规则 | 阈值 | 说明 |
|------|------|------|
| **回放次数** | ≥ T1（如2次） | 学生重复观看同一片段 |
| **暂停次数** | ≥ T2（如3次） | 在该知识点区间频繁暂停 |
| **停留时长比** | ≥ T3（如3倍） | 停留时长/视频段时长 ≥ 3 |
| **拖拽回放** | ≥ T4（如2次） | 向后拖拽回看 |
| **暂停后回看** | 是 | 暂停后立即回看前10秒 |

**困难度分数计算**（示例）：
```
Di = w1 × (回放次数/T1) + w2 × (暂停次数/T2) + w3 × (停留时长比/T3)
```
其中w1, w2, w3为权重系数，可配置。

#### B3.2 公共难点识别
- 若某视频片段被多人（如≥5人）反复观看，自动标记为"公共难点"
- 提升该知识点的优先级，供教师重点关注

#### B3.3 个体弱项诊断
- 若特定学生多次回放某片段，标记为"个体弱项"
- 纳入个人学习画像，用于个性化路径规划

#### B3.4 难点判定模型（v2.0可选）
- 规则-based + 轻量ML模型
- 或直接使用多模态大模型进行行为理解
- 提高判定准确率，减少误报/漏报

### 3.2.4 输出

**学生-知识点掌握状态**：
- **未学**：尚未观看该知识点
- **学习中**：正在观看，行为正常
- **疑难**：检测到异常行为，标记为疑难点
- **已掌握**：完成补偿后，练习正确率达标

**疑难知识点列表**：
```json
{
  "user_id": "U001",
  "video_id": "V001",
  "difficult_points": [
    {
      "kp_id": "K3",
      "kp_name": "多表连接",
      "difficulty_score": 0.85,
      "triggers": [
        {"type": "replay", "count": 3, "threshold": 2},
        {"type": "stay_duration", "ratio": 3.5, "threshold": 3.0}
      ],
      "detected_at": "2024-01-15 10:30:00"
    }
  ]
}
```

### 3.2.5 验收标准
- ✅ 能对单个学生一次观看记录生成"疑难知识点TopK"及触发原因
- ✅ 教师端可查看班级层面的疑难分布（按知识点聚合）
- ✅ 难点判定必须给出触发原因（可解释性）
- ✅ 支持阈值T1/T2/T3可配置

---

## 3.3 模块C：个性化学习路径生成与智能补偿（核心竞争力）

### 3.3.1 模块目标
识别疑难点后，系统**主动推送**补偿资源，并根据反馈动态调整学习路径，实现"一人一策"。

### 3.3.2 补偿资源类型

#### C2.1 知识卡片（必须）
- **内容**：概念/公式/关键步骤（1屏可读）
- **格式**：图文混排，支持Markdown
- **特点**：短小精悍，直击痛点

#### C2.2 诊断练习（必须）
- **题型**：选择/填空/判断/简答（至少3题）
- **生成方式**：可自动生成+人工编辑
- **要求**：
  - 每道题带详细解析
  - 难度与知识点匹配
  - 支持自动判分

#### C2.3 精讲微视频（最高优先级）
- **时长**：3-8分钟
- **内容**：针对该知识点的精讲
- **生成方式**（待讨论）：
  - Sora-like模型生成
  - CogVideo生成
  - 图文→视频（Runway、Luma、Kling）
  - 或从原视频智能剪辑

#### C2.4 其他资源类型（可选扩展）
- 例题讲解
- 知识图谱节点跳转
- 3D拆解动画（针对实操类）
- 思维导图

### 3.3.3 推送策略（MVP）

#### C3.1 触发条件
当知识点Ki被标记为疑难时，系统**必须在5分钟内**执行补偿推送。

#### C3.2 默认推送组合
- **知识卡片 + 诊断练习**（默认组合）
- 或根据知识点类型动态选择资源类型

#### C3.3 反馈闭环机制

**场景1：补偿成功**
- 若练习正确率 ≥ P1（如80%）：标记"已掌握"
- 减少后续推送频率
- 更新学习路径，跳过重复内容

**场景2：补偿未成功**
- 若正确率 < P1：升级干预
- 追加更详细的例题讲解
- 或拆分为更细的子知识点进行补偿

**场景3：多轮递进式干预**
- 首次卡顿：推送文字提示
- 二次卡顿：推送短视频
- 三次卡顿：推送1对1答疑入口（避免干预疲劳）

#### C3.4 推送方式（待讨论）
- **自动弹出**：强打断，可能影响学习体验
- **提示可点开**：非强打断，建议侧边栏/浮层（推荐）
- **学生主动求助按钮**：老师倾向弱化，但可作为备选

### 3.3.4 学习路径表示

对每个学生生成个性化路径Path：

```json
{
  "user_id": "U001",
  "current_progress": {
    "video_id": "V001",
    "current_kp": "K5",
    "completion_rate": 0.65
  },
  "difficult_points": [
    {
      "kp_id": "K3",
      "status": "compensated",
      "compensation_completed": true,
      "exercise_score": 0.85
    }
  ],
  "next_suggestion": {
    "action": "continue_watch",
    "target_kp": "K6",
    "reason": "前置知识点已掌握"
  },
  "learning_path": [
    {"kp_id": "K1", "status": "mastered", "order": 1},
    {"kp_id": "K2", "status": "mastered", "order": 2},
    {"kp_id": "K3", "status": "difficult", "order": 3, "compensation_required": true},
    {"kp_id": "K4", "status": "skipped", "order": 4, "reason": "已掌握前置知识"},
    {"kp_id": "K5", "status": "learning", "order": 5}
  ]
}
```

**路径属性**：
- 当前学习进度（到哪个知识点）
- 疑难点及补偿完成情况
- 下一步建议（继续看/先补偿/做练习/复习）
- 已跳过知识点（已掌握，无需重复学习）

### 3.3.5 动态路径调整

**调整策略**：
- 跳过已掌握的基础环节，直接进入实操或难点环节
- 模仿京东推荐机制，动态生成个性化学习路径
- 根据学习反馈实时调整后续推荐顺序

### 3.3.6 补偿资源要求

- **时长控制**：补偿资源时长控制在8分钟以内
- **质量要求**：必须"**短、狠、准**"，直击痛点
- **反馈机制**：支持学生标记"已掌握"或"仍不懂"
- **人工审核**：初版允许人工审核/编辑，保证质量

### 3.3.7 验收标准
- ✅ 对触发疑难的知识点，系统能在界面中展示补偿入口
- ✅ 记录学生完成补偿的情况
- ✅ 学生完成练习后，系统会更新该知识点状态（疑难→已掌握/仍疑难）
- ✅ 响应时间：行为检测 → 补偿推送 ≤ 3-5分钟
- ✅ 补偿资源生成质量是**核心指标**，重于技术指标

---

## 3.4 模块D：教师赋能工具链（新增）

### 3.4.1 教师标注工作台
- **功能**：提供可视化界面，支持快速修正AI识别的知识点标签
- **操作**：
  - 调整知识点边界（起止时间）
  - 修改知识点名称、摘要、关键词
  - 补充术语库
  - 审核补偿资源
  - 标注知识点难度等级

### 3.4.2 教学效果仪表盘
- **展示内容**：
  - 班级整体薄弱点排行
  - 每个知识点的"回放热力/暂停热力"可视化
  - 补偿资源使用量与效果
  - 干预效果统计（补偿后掌握率提升）
  - 学生学习进度分布
- **数据导出**：支持导出Excel/PDF报告

### 3.4.3 一键生成课件
- **功能**：基于多模态解析结果，自动生成教学课件
- **包含内容**：
  - 知识点列表（带时间戳）
  - 关键截图/视频片段
  - 补偿资源链接
  - 学生薄弱点统计
- **格式**：PPT/PDF，减轻备课负担

---

## 3.5 模块E：用户管理与权限系统

### 3.5.1 用户角色
- **学生**：观看视频、接收补偿、完成练习
- **教师**：上传视频、查看学情、审核资源
- **管理员**：系统配置、用户管理、数据维护

### 3.5.2 权限控制
- 学生只能查看自己的学习数据
- 教师可查看所教班级的学情数据
- 管理员拥有全部权限

---

## 3.6 模块F：数据统计与分析（扩展）

### 3.6.1 学习数据分析
- 个人学习报告（周报/月报）
- 知识点掌握率趋势
- 学习时长统计
- 薄弱点分析

### 3.6.2 教学效果分析
- 班级整体学习效果
- 知识点难度评估
- 补偿资源有效性评估
- 教学策略优化建议

---

# 4. 系统架构与技术方案

## 4.1 总体架构

```
┌─────────────────────────────────────────────────────────┐
│                      前端层 (Web)                        │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐             │
│  │ 学生端   │  │ 教师端   │  │ 管理端   │             │
│  └──────────┘  └──────────┘  └──────────┘             │
└─────────────────────────────────────────────────────────┘
                          │
                          │ HTTP/WebSocket
                          ▼
┌─────────────────────────────────────────────────────────┐
│                      后端服务层                          │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐             │
│  │业务逻辑  │  │行为采集  │  │路径生成  │             │
│  └──────────┘  └──────────┘  └──────────┘             │
└─────────────────────────────────────────────────────────┘
                          │
                          │ API调用
                          ▼
┌─────────────────────────────────────────────────────────┐
│                      AI引擎层                             │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐             │
│  │多模态解析│  │难点识别  │  │资源生成  │             │
│  └──────────┘  └──────────┘  └──────────┘             │
└─────────────────────────────────────────────────────────┘
                          │
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│                      数据存储层                           │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐             │
│  │关系数据库│  │文件存储  │  │缓存系统  │             │
│  └──────────┘  └──────────┘  └──────────┘             │
└─────────────────────────────────────────────────────────┘
```

## 4.2 技术栈建议（仅供参考）

### 4.2.1 前端
- **框架**：Vue.js / React
- **UI组件库**：Element UI / Ant Design
- **视频播放器**：Video.js / DPlayer（支持行为事件采集）
- **可视化**：ECharts / D3.js

### 4.2.2 后端
- **框架**：Spring Boot / Django / FastAPI
- **数据库**：MySQL / PostgreSQL（关系数据）
- **缓存**：Redis
- **消息队列**：RabbitMQ / Kafka（异步处理）

### 4.2.3 AI引擎
- **多模态大模型**：GPT-4V / Claude / 文心一言 / 通义千问
- **ASR**：讯飞语音 / 百度语音 / Whisper
- **OCR**：PaddleOCR / 百度OCR / 腾讯OCR
- **视频处理**：FFmpeg
- **知识图谱**：Neo4j（可选）

### 4.2.4 部署
- **容器化**：Docker
- **编排**：Docker Compose / Kubernetes（可选）
- **服务器**：Linux

## 4.3 核心约束
- 必须优先保证对"职教知识视频"的适配性
- 严格排除娱乐类内容干扰
- 聚焦职业教育场景
- 技术实现不是重点，核心在于"点子"和"需求"

---

# 5. 数据模型设计

## 5.1 核心实体

### 5.1.1 用户表 (User)
```sql
CREATE TABLE user (
    id VARCHAR(50) PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    role ENUM('student', 'teacher', 'admin') NOT NULL,
    class_id VARCHAR(50),
    profile JSON,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### 5.1.2 视频表 (Video)
```sql
CREATE TABLE video (
    id VARCHAR(50) PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    course_id VARCHAR(50),
    duration INT,  -- 秒
    url VARCHAR(500),
    thumbnail_url VARCHAR(500),
    metadata JSON,  -- 存储视频元数据
    status ENUM('processing', 'ready', 'failed') DEFAULT 'processing',
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 5.1.3 知识点表 (KnowledgePoint)
```sql
CREATE TABLE knowledge_point (
    id VARCHAR(50) PRIMARY KEY,
    video_id VARCHAR(50) NOT NULL,
    title VARCHAR(200) NOT NULL,
    start_time INT NOT NULL,  -- 秒
    end_time INT NOT NULL,    -- 秒
    keywords TEXT,  -- JSON数组
    summary TEXT,
    kp_type ENUM('concept', 'skill', 'example', 'practice'),
    difficulty_level ENUM('basic', 'intermediate', 'advanced'),
    importance_score INT,  -- 1-5
    parent_kp_id VARCHAR(50),  -- 父知识点
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (video_id) REFERENCES video(id)
);
```

### 5.1.4 知识点关系表 (KnowledgePointRelation)
```sql
CREATE TABLE kp_relation (
    id VARCHAR(50) PRIMARY KEY,
    from_kp_id VARCHAR(50) NOT NULL,
    to_kp_id VARCHAR(50) NOT NULL,
    relation_type ENUM('prerequisite', 'next', 'related'),
    weight FLOAT,  -- 关联度
    FOREIGN KEY (from_kp_id) REFERENCES knowledge_point(id),
    FOREIGN KEY (to_kp_id) REFERENCES knowledge_point(id)
);
```

### 5.1.5 观看事件表 (WatchEvent)
```sql
CREATE TABLE watch_event (
    id VARCHAR(50) PRIMARY KEY,
    user_id VARCHAR(50) NOT NULL,
    video_id VARCHAR(50) NOT NULL,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    event_type ENUM('play', 'pause', 'seek', 'rate_change', 'ended', 'leave'),
    payload JSON,  -- 存储事件详细信息
    FOREIGN KEY (user_id) REFERENCES user(id),
    FOREIGN KEY (video_id) REFERENCES video(id),
    INDEX idx_user_video (user_id, video_id),
    INDEX idx_timestamp (timestamp)
);
```

### 5.1.6 掌握状态表 (Mastery)
```sql
CREATE TABLE mastery (
    id VARCHAR(50) PRIMARY KEY,
    user_id VARCHAR(50) NOT NULL,
    kp_id VARCHAR(50) NOT NULL,
    status ENUM('unlearned', 'learning', 'difficult', 'mastered') DEFAULT 'unlearned',
    difficulty_score FLOAT,  -- 0-1
    last_updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES user(id),
    FOREIGN KEY (kp_id) REFERENCES knowledge_point(id),
    UNIQUE KEY uk_user_kp (user_id, kp_id)
);
```

### 5.1.7 补偿资源表 (Resource)
```sql
CREATE TABLE resource (
    id VARCHAR(50) PRIMARY KEY,
    kp_id VARCHAR(50) NOT NULL,
    resource_type ENUM('card', 'exercise', 'video', 'mindmap', 'other'),
    title VARCHAR(200),
    content TEXT,  -- JSON或文本内容
    source ENUM('ai_generated', 'manual', 'external'),
    version INT DEFAULT 1,
    status ENUM('draft', 'approved', 'rejected') DEFAULT 'draft',
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (kp_id) REFERENCES knowledge_point(id)
);
```

### 5.1.8 练习题表 (Exercise)
```sql
CREATE TABLE exercise (
    id VARCHAR(50) PRIMARY KEY,
    kp_id VARCHAR(50) NOT NULL,
    title VARCHAR(200),
    questions JSON NOT NULL,  -- 题目列表
    answer_key JSON NOT NULL,  -- 答案与解析
    difficulty ENUM('easy', 'medium', 'hard'),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (kp_id) REFERENCES knowledge_point(id)
);
```

### 5.1.9 练习结果表 (ExerciseResult)
```sql
CREATE TABLE exercise_result (
    id VARCHAR(50) PRIMARY KEY,
    user_id VARCHAR(50) NOT NULL,
    exercise_id VARCHAR(50) NOT NULL,
    kp_id VARCHAR(50) NOT NULL,
    score FLOAT,  -- 0-1
    detail JSON,  -- 存储每道题的答案与判分详情
    submitted_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES user(id),
    FOREIGN KEY (exercise_id) REFERENCES exercise(id),
    FOREIGN KEY (kp_id) REFERENCES knowledge_point(id),
    INDEX idx_user_kp (user_id, kp_id)
);
```

### 5.1.10 学习路径表 (LearningPath)
```sql
CREATE TABLE learning_path (
    id VARCHAR(50) PRIMARY KEY,
    user_id VARCHAR(50) NOT NULL,
    video_id VARCHAR(50) NOT NULL,
    path_data JSON NOT NULL,  -- 存储路径序列与状态
    current_kp_id VARCHAR(50),
    completion_rate FLOAT DEFAULT 0,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES user(id),
    FOREIGN KEY (video_id) REFERENCES video(id)
);
```

### 5.1.11 课程表 (Course)
```sql
CREATE TABLE course (
    id VARCHAR(50) PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    description TEXT,
    category VARCHAR(100),  -- 课程分类
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 5.1.12 补偿推送记录表 (CompensationLog)
```sql
CREATE TABLE compensation_log (
    id VARCHAR(50) PRIMARY KEY,
    user_id VARCHAR(50) NOT NULL,
    kp_id VARCHAR(50) NOT NULL,
    resource_id VARCHAR(50),
    push_type ENUM('auto', 'manual'),
    push_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    user_feedback ENUM('helpful', 'not_helpful', 'no_feedback'),
    FOREIGN KEY (user_id) REFERENCES user(id),
    FOREIGN KEY (kp_id) REFERENCES knowledge_point(id),
    FOREIGN KEY (resource_id) REFERENCES resource(id)
);
```

## 5.2 数据关系图

```
User ──┬── WatchEvent ──→ Video
       │
       ├── Mastery ──→ KnowledgePoint ──→ Video
       │
       ├── ExerciseResult ──→ Exercise ──→ KnowledgePoint
       │
       ├── LearningPath ──→ Video
       │
       └── CompensationLog ──→ KnowledgePoint ──→ Resource

KnowledgePoint ──→ KnowledgePointRelation (自关联)
Resource ──→ KnowledgePoint
Exercise ──→ KnowledgePoint
Video ──→ Course
```

---

# 6. 接口设计

## 6.1 视频相关接口

### 6.1.1 上传视频
- **接口**: `POST /api/videos/upload`
- **描述**: 教师上传教学视频
- **请求参数**:
  ```json
  {
    "file": "视频文件",
    "title": "视频标题",
    "course_id": "课程ID",
    "subtitle_file": "字幕文件（可选）",
    "ppt_file": "PPT文件（可选）"
  }
  ```
- **响应**:
  ```json
  {
    "code": 200,
    "data": {
      "video_id": "V001",
      "status": "processing",
      "message": "视频上传成功，正在解析中"
    }
  }
  ```

### 6.1.2 获取视频列表
- **接口**: `GET /api/videos`
- **描述**: 获取视频列表
- **请求参数**: `?course_id=xxx&page=1&page_size=20`
- **响应**:
  ```json
  {
    "code": 200,
    "data": {
      "total": 100,
      "videos": [
        {
          "id": "V001",
          "title": "数据库-SELECT查询",
          "duration": 3600,
          "thumbnail_url": "...",
          "status": "ready"
        }
      ]
    }
  }
  ```

### 6.1.3 获取视频知识点
- **接口**: `GET /api/videos/{video_id}/knowledge-points`
- **描述**: 获取视频的知识点列表
- **响应**:
  ```json
  {
    "code": 200,
    "data": {
      "video_id": "V001",
      "knowledge_points": [
        {
          "id": "K1",
          "title": "SELECT基础语法",
          "start_time": 0,
          "end_time": 300,
          "keywords": ["SELECT", "FROM", "WHERE"],
          "summary": "介绍SELECT语句的基本语法结构",
          "difficulty_level": "basic"
        }
      ]
    }
  }
  ```

## 6.2 学习行为接口

### 6.2.1 上报观看事件
- **接口**: `POST /api/watch-events`
- **描述**: 前端实时上报观看行为事件
- **请求参数**:
  ```json
  {
    "user_id": "U001",
    "video_id": "V001",
    "event_type": "pause",
    "timestamp": "2024-01-15T10:30:00Z",
    "payload": {
      "pause_position": 150,
      "pause_duration": 30
    }
  }
  ```
- **响应**:
  ```json
  {
    "code": 200,
    "message": "事件记录成功"
  }
  ```

### 6.2.2 获取难点诊断结果
- **接口**: `GET /api/users/{user_id}/difficult-points`
- **描述**: 获取学生的疑难知识点列表
- **响应**:
  ```json
  {
    "code": 200,
    "data": {
      "difficult_points": [
        {
          "kp_id": "K3",
          "kp_name": "多表连接",
          "difficulty_score": 0.85,
          "triggers": [
            {"type": "replay", "count": 3, "threshold": 2},
            {"type": "stay_duration", "ratio": 3.5, "threshold": 3.0}
          ],
          "detected_at": "2024-01-15T10:30:00Z"
        }
      ]
    }
  }
  ```

## 6.3 补偿资源接口

### 6.3.1 获取补偿资源
- **接口**: `GET /api/knowledge-points/{kp_id}/resources`
- **描述**: 获取知识点的补偿资源
- **响应**:
  ```json
  {
    "code": 200,
    "data": {
      "kp_id": "K3",
      "resources": [
        {
          "id": "R001",
          "type": "card",
          "title": "多表连接知识卡片",
          "content": "..."
        },
        {
          "id": "R002",
          "type": "exercise",
          "title": "多表连接诊断练习",
          "question_count": 3
        },
        {
          "id": "R003",
          "type": "video",
          "title": "多表连接精讲",
          "duration": 300,
          "url": "..."
        }
      ]
    }
  }
  ```

### 6.3.2 提交练习结果
- **接口**: `POST /api/exercises/{exercise_id}/submit`
- **描述**: 学生提交练习答案
- **请求参数**:
  ```json
  {
    "user_id": "U001",
    "answers": [
      {"question_id": "Q1", "answer": "A"},
      {"question_id": "Q2", "answer": "B"}
    ]
  }
  ```
- **响应**:
  ```json
  {
    "code": 200,
    "data": {
      "score": 0.85,
      "detail": [
        {"question_id": "Q1", "correct": true, "explanation": "..."},
        {"question_id": "Q2", "correct": true, "explanation": "..."}
      ],
      "mastery_updated": true,
      "new_status": "mastered"
    }
  }
  ```

### 6.3.3 反馈补偿资源
- **接口**: `POST /api/resources/{resource_id}/feedback`
- **描述**: 学生对补偿资源进行反馈
- **请求参数**:
  ```json
  {
    "user_id": "U001",
    "kp_id": "K3",
    "feedback": "helpful"  // helpful / not_helpful
  }
  ```

## 6.4 学习路径接口

### 6.4.1 获取个人学习路径
- **接口**: `GET /api/users/{user_id}/learning-path?video_id=V001`
- **描述**: 获取学生的个性化学习路径
- **响应**:
  ```json
  {
    "code": 200,
    "data": {
      "current_progress": {
        "video_id": "V001",
        "current_kp": "K5",
        "completion_rate": 0.65
      },
      "difficult_points": [...],
      "next_suggestion": {
        "action": "continue_watch",
        "target_kp": "K6",
        "reason": "前置知识点已掌握"
      },
      "learning_path": [...]
    }
  }
  ```

## 6.5 教师端接口

### 6.5.1 获取班级学情
- **接口**: `GET /api/teachers/{teacher_id}/class-statistics?course_id=C001`
- **描述**: 获取班级整体学情数据
- **响应**:
  ```json
  {
    "code": 200,
    "data": {
      "difficult_kp_ranking": [
        {
          "kp_id": "K3",
          "kp_name": "多表连接",
          "difficult_count": 15,
          "avg_replay": 4.2
        }
      ],
      "heatmap_data": {...},
      "compensation_stats": {
        "usage_count": 250,
        "effectiveness": 0.78
      }
    }
  }
  ```

### 6.5.2 编辑知识点
- **接口**: `PUT /api/knowledge-points/{kp_id}`
- **描述**: 教师编辑知识点信息
- **请求参数**:
  ```json
  {
    "title": "修改后的知识点名称",
    "start_time": 100,
    "end_time": 400,
    "keywords": ["新关键词"],
    "summary": "新摘要",
    "difficulty_level": "intermediate"
  }
  ```

---

# 7. 用户界面设计

## 7.1 学生端界面

### 7.1.1 视频播放页
**布局结构**:
```
┌─────────────────────────────────────────────────┐
│  导航栏: [首页] [我的学习] [个人中心]            │
├─────────────────────────────────────────────────┤
│                                                  │
│  ┌──────────────────────┐  ┌─────────────────┐ │
│  │                      │  │ 知识点目录      │ │
│  │                      │  │ ┌─────────────┐ │ │
│  │   视频播放器         │  │ │ K1: SELECT  │ │ │
│  │                      │  │ │ K2: WHERE   │ │ │
│  │                      │  │ │ K3: 多表连接│ │ │
│  │                      │  │ │   ⚠️ 疑难点 │ │ │
│  └──────────────────────┘  │ └─────────────┘ │ │
│                            │                  │ │
│                            │ 补偿资源提示     │ │
│                            │ ┌─────────────┐ │ │
│                            │ │ 💡 检测到疑 │ │ │
│                            │ │   难点，推  │ │ │
│                            │ │   荐补偿资源│ │ │
│                            │ │ [查看详情]  │ │ │
│                            │ └─────────────┘ │ │
└─────────────────────────────────────────────────┘
```

**功能要点**:
- 视频播放器支持播放、暂停、拖拽、倍速
- 实时采集行为事件（不打断用户体验）
- 知识点目录可点击跳转
- 疑难点标记（⚠️图标）
- 补偿资源提示（侧边栏浮层，非强制弹出）

### 7.1.2 补偿资源页
**布局结构**:
```
┌─────────────────────────────────────────────────┐
│  知识点: 多表连接                               │
├─────────────────────────────────────────────────┤
│                                                  │
│  ┌──────────────────────────────────────────┐  │
│  │ 📄 知识卡片                              │  │
│  │ ┌──────────────────────────────────────┐ │  │
│  │ │ 多表连接语法:                        │ │  │
│  │ │ SELECT ... FROM table1               │ │  │
│  │ │ JOIN table2 ON ...                   │ │  │
│  │ └──────────────────────────────────────┘ │  │
│  └──────────────────────────────────────────┘  │
│                                                  │
│  ┌──────────────────────────────────────────┐  │
│  │ 📝 诊断练习 (3题)                       │  │
│  │ 1. 选择题: ...                          │  │
│  │ 2. 填空题: ...                          │  │
│  │ 3. 判断题: ...                          │  │
│  │ [提交答案]                              │  │
│  └──────────────────────────────────────────┘  │
│                                                  │
│  ┌──────────────────────────────────────────┐  │
│  │ 🎥 精讲微视频 (5分钟)                    │  │
│  │ [播放视频]                               │  │
│  └──────────────────────────────────────────┘  │
│                                                  │
│  [标记已掌握] [仍不懂]                          │
└─────────────────────────────────────────────────┘
```

### 7.1.3 学习路径/进度页
**布局结构**:
```
┌─────────────────────────────────────────────────┐
│  我的学习路径                                    │
├─────────────────────────────────────────────────┤
│  当前进度: 65%                                   │
│  ┌──────────────────────────────────────────┐  │
│  │ ████████████████░░░░░░░░░░░░░░░░░░░░░░░  │  │
│  └──────────────────────────────────────────┘  │
│                                                  │
│  学习路径:                                       │
│  ✅ K1: SELECT基础 (已掌握)                      │
│  ✅ K2: WHERE条件 (已掌握)                      │
│  ⚠️  K3: 多表连接 (疑难 - 补偿中)               │
│  ⏭️  K4: 子查询 (已跳过 - 前置知识已掌握)        │
│  🔄 K5: 聚合函数 (学习中)                        │
│  ⏸️  K6: HAVING子句 (未学)                      │
│                                                  │
│  下一步建议: 继续学习 K5: 聚合函数              │
│  [继续学习] [查看详情]                          │
└─────────────────────────────────────────────────┘
```

## 7.2 教师端界面

### 7.2.1 教学效果仪表盘
**布局结构**:
```
┌─────────────────────────────────────────────────┐
│  教学效果仪表盘 - 《数据库-SELECT查询》          │
├─────────────────────────────────────────────────┤
│                                                  │
│  ┌──────────────────┐  ┌──────────────────┐     │
│  │ 班级疑难排行     │  │ 学情热力图       │     │
│  │ 1. K3 多表连接   │  │ [时间轴热力图]   │     │
│  │    15人 4.2次    │  │                  │     │
│  │ 2. K7 子查询     │  │                  │     │
│  │    12人 3.8次    │  │                  │     │
│  └──────────────────┘  └──────────────────┘     │
│                                                  │
│  ┌──────────────────────────────────────────┐  │
│  │ 补偿资源效果                              │  │
│  │ 使用量: 知识卡片120次 | 练习题85次 | ...  │  │
│  │ 掌握率提升: 45% → 78%                    │  │
│  └──────────────────────────────────────────┘  │
│                                                  │
│  [导出报告] [优化教学]                          │
└─────────────────────────────────────────────────┘
```

### 7.2.2 教师标注工作台
**功能**: 可视化编辑知识点边界、名称、摘要等

---

# 8. 非功能性需求

## 8.1 性能要求

- **视频解析响应时间**: 上传后24小时内完成解析（可异步处理）
- **行为检测响应时间**: 实时采集，延迟 < 1秒
- **补偿推送响应时间**: 行为检测 → 补偿推送 ≤ 3-5分钟
- **接口响应时间**: API接口平均响应时间 < 500ms
- **视频播放流畅度**: 支持1080p流畅播放，缓冲时间 < 3秒

## 8.2 可用性要求

- **系统可用性**: ≥ 99%（7×24小时）
- **视频播放与事件采集**: 不应明显卡顿
- **界面响应**: 用户操作响应时间 < 200ms

## 8.3 准确性要求

- **知识点识别准确率**: ≥ 85%（v1.0）
- **ASR识别准确率**: ≥ 90%
- **OCR识别准确率**: ≥ 85%
- **难点判定准确率**: ≥ 80%（减少误报/漏报）

## 8.4 可解释性要求

- **难点判定**: 必须给出触发原因（可解释性）
- **路径推荐**: 提供推荐理由
- **补偿资源**: 说明为什么推送该资源

## 8.5 可控性要求

- **知识点切分**: 允许人工修订
- **资源内容**: 允许人工审核/编辑
- **阈值配置**: T1/T2/T3等阈值可配置

## 8.6 安全性要求

- **隐私保护**: 
  - 仅采集学习相关行为数据
  - 不采集与课程无关信息
  - 数据脱敏展示
  - 学习行为数据本地化或强加密
- **权限控制**: 学生只能查看自己的数据，教师只能查看所教班级数据
- **数据安全**: 敏感数据加密存储，API接口需要身份认证

## 8.7 可扩展性要求

- **模块化设计**: 各功能模块相对独立，便于扩展
- **接口标准化**: 支持后续功能扩展
- **数据模型**: 支持新字段扩展（使用JSON字段存储灵活数据）

## 8.8 兼容性要求

- **浏览器兼容**: 支持Chrome、Firefox、Edge最新版本
- **视频格式**: 支持MP4、WebM等主流格式
- **移动端**: 响应式设计，支持移动端浏览器访问（优先Web端）

---

# 9. 测试与验收标准

## 9.1 功能测试

### 9.1.1 视频解析模块测试
- ✅ 上传视频后能成功解析出知识点
- ✅ 知识点数量符合要求（10-30个）
- ✅ 知识点时间戳准确
- ✅ 支持人工编辑知识点

### 9.1.2 行为采集模块测试
- ✅ 能正确采集所有行为事件（play/pause/seek等）
- ✅ 事件时间戳准确
- ✅ 行为数据能正确存储

### 9.1.3 难点识别模块测试
- ✅ 能正确识别疑难点（基于规则）
- ✅ 触发原因可解释
- ✅ 公共难点识别准确
- ✅ 个体弱项诊断准确

### 9.1.4 补偿推送模块测试
- ✅ 检测到疑难点后能及时推送补偿资源
- ✅ 补偿资源类型正确（卡片/练习/视频）
- ✅ 学生完成练习后能正确更新状态
- ✅ 反馈闭环机制正常工作

### 9.1.5 学习路径模块测试
- ✅ 能生成个性化学习路径
- ✅ 路径能根据反馈动态调整
- ✅ 跳过已掌握知识点功能正常

## 9.2 性能测试

- ✅ 视频解析在24小时内完成
- ✅ 补偿推送响应时间 ≤ 5分钟
- ✅ API接口响应时间 < 500ms
- ✅ 视频播放流畅，无明显卡顿

## 9.3 准确性测试

- ✅ 知识点识别准确率 ≥ 85%
- ✅ ASR识别准确率 ≥ 90%
- ✅ 难点判定准确率 ≥ 80%

## 9.4 用户体验测试

- ✅ 界面操作流畅，无明显延迟
- ✅ 补偿推送不打断学习体验（侧边栏/浮层）
- ✅ 功能易用，无需培训即可使用

## 9.5 验收标准总结

**MVP版本必须满足**:
1. 能完成完整的"感知-分析-干预-反馈"闭环
2. 至少支持一个课程/一类视频形态
3. 补偿推送功能正常工作
4. 教师端能查看基本学情数据
5. 所有核心功能验收标准达标

---

# 10. 项目里程碑与任务规划

## 10.1 总体时间规划（建议16周）

### 阶段一：需求分析与设计（2周）
- **第1周**:
  - 选定具体课程/样例视频（1-3个）
  - 明确知识点粒度（预计10-30个）
  - 完成需求文档（本文件）
  - 输出系统流程图（感知→分析→干预→反馈）
  - 团队内部研讨、头脑风暴

- **第2周**:
  - 产出低保真原型（Figma/墨刀/手绘）
  - 定义疑难阈值T1/T2/T3与正确率阈值P1
  - 准备最小补偿资源样例（3个知识点，每个：卡片+3题）
  - 技术调研（多模态解析、路径生成算法）

### 阶段二：MVP原型开发（6周）
- **第3-4周**: 视频多模态解析模块
  - 实现ASR语音转写
  - 实现OCR文字识别
  - 实现知识点切分
  - 实现知识点标注界面

- **第5周**: 行为采集与难点识别模块
  - 实现前端行为事件采集
  - 实现后端事件存储
  - 实现难点判定规则引擎

- **第6-7周**: 补偿推送与学习路径模块
  - 实现补偿资源管理
  - 实现推送机制
  - 实现学习路径生成
  - 实现练习提交与判分

- **第8周**: 教师端与管理端
  - 实现教师标注工作台
  - 实现教学效果仪表盘
  - 实现用户管理

### 阶段三：测试与优化（4周）
- **第9-10周**: 功能测试与修复
  - 完成所有功能测试
  - 修复发现的bug
  - 优化性能

- **第11周**: 用户体验优化
  - 界面优化
  - 交互优化
  - 响应速度优化

- **第12周**: 集成测试与验收
  - 端到端测试
  - 验收测试
  - 准备演示

### 阶段四：迭代与扩展（4周，可选）
- **第13-16周**: 
  - 根据反馈迭代优化
  - 扩展新功能
  - 准备项目答辩

## 10.2 本周任务（需求阶段）

- [ ] 选定一个具体课程/样例视频（1-3个）
- [ ] 明确知识点粒度（预计10-30个）
- [ ] 完成v0.1需求文档（本文件）
- [ ] 输出一张系统流程图（感知→分析→干预→反馈）
- [ ] 团队内部研讨、头脑风暴

## 10.3 下周任务（MVP原型阶段）

- [ ] 产出低保真原型（Figma/墨刀/手绘均可）
- [ ] 定义疑难阈值T1/T2/T3与正确率阈值P1
- [ ] 准备最小补偿资源样例（3个知识点，每个：卡片+3题）
- [ ] 技术调研报告

## 10.4 关键里程碑

| 里程碑 | 时间 | 交付物 |
|--------|------|--------|
| M1: 需求确认 | 第2周末 | 需求文档、原型图 |
| M2: 解析模块完成 | 第4周末 | 视频解析功能可用 |
| M3: 核心闭环完成 | 第7周末 | 完整的学习闭环可用 |
| M4: MVP版本完成 | 第8周末 | 所有核心功能完成 |
| M5: 测试完成 | 第12周末 | 测试报告、演示视频 |
| M6: 项目交付 | 第16周末 | 最终版本、项目报告 |

---

# 11. 风险与对策

## 11.1 技术风险

### 风险1: 多模态解析效果不稳定
- **风险描述**: ASR/OCR识别准确率不达标，知识点切分不准确
- **影响程度**: 高
- **应对策略**:
  - 先用"ASR+字幕/PPT文本"为主，OCR/视觉作为增强
  - 提供人工编辑兜底机制
  - 建立术语库提升识别准确率
  - 支持教师一键修正识别错误

### 风险2: 难点判定误报/漏报
- **风险描述**: 规则策略可能产生误判，将"走神"误判为"疑难"
- **影响程度**: 高
- **应对策略**:
  - 初版用可解释规则+阈值可配置
  - 支持多指标组合判定，减少单一指标误判
  - 后续迭代引入ML模型提高准确率
  - 允许学生反馈"误判"，系统学习优化

### 风险3: 补偿资源质量参差
- **风险描述**: AI生成的补偿资源质量不稳定，可能不够精准
- **影响程度**: 高
- **应对策略**:
  - 初版允许人工审核/编辑
  - 优先做"短小可用"的资源
  - 建立资源质量评估机制
  - 收集学生反馈，持续优化生成策略

### 风险4: 补偿短视频生成技术难度大
- **风险描述**: 视频生成技术复杂，可能无法在MVP版本实现
- **影响程度**: 中
- **应对策略**:
  - MVP版本优先实现知识卡片和练习题
  - 视频生成作为可选功能，可先用原视频智能剪辑
  - 或对接第三方视频生成API（Runway、Luma等）

## 11.2 业务风险

### 风险5: 范围过大，无法闭环
- **风险描述**: 功能过多，无法在有限时间内完成完整闭环
- **影响程度**: 高
- **应对策略**:
  - 固定课程、固定视频形态、固定资源类型
  - 先闭环再扩展
  - 明确MVP边界，非核心功能延后

### 风险6: 用户接受度低
- **风险描述**: 学生/教师不习惯新系统，使用率低
- **影响程度**: 中
- **应对策略**:
  - 注重用户体验设计，界面简洁易用
  - 补偿推送采用非强制方式（侧边栏/浮层）
  - 提供使用培训/帮助文档
  - 收集用户反馈，快速迭代

## 11.3 数据风险

### 风险7: 数据量过大，性能瓶颈
- **风险描述**: 行为事件数据量大，可能影响系统性能
- **影响程度**: 中
- **应对策略**:
  - 使用消息队列异步处理
  - 定期归档历史数据
  - 使用缓存优化查询性能
  - 数据库索引优化

### 风险8: 隐私安全问题
- **风险描述**: 学习行为数据涉及隐私，可能引发安全问题
- **影响程度**: 高
- **应对策略**:
  - 仅采集学习相关数据
  - 数据加密存储
  - 数据脱敏展示
  - 遵循数据保护法规

## 11.4 团队风险

### 风险9: 技术难度超出团队能力
- **风险描述**: 多模态解析、AI生成等技术难度高
- **影响程度**: 中
- **应对策略**:
  - 充分利用技术顾问（蒋国伟）的经验
  - 使用成熟的第三方API/工具
  - 分阶段实现，先做简单版本
  - 加强团队技术培训

### 风险10: 时间进度延误
- **风险描述**: 开发进度可能无法按计划完成
- **影响程度**: 中
- **应对策略**:
  - 明确优先级，先做核心功能
  - 定期进度检查，及时调整计划
  - 预留缓冲时间
  - 必要时缩减功能范围

---

# 12. 附录

## 12.1 术语表

| 术语 | 英文 | 说明 |
|------|------|------|
| ASR | Automatic Speech Recognition | 自动语音识别 |
| OCR | Optical Character Recognition | 光学字符识别 |
| CV | Computer Vision | 计算机视觉 |
| MVP | Minimum Viable Product | 最小可行产品 |
| LMS | Learning Management System | 学习管理系统 |
| 知识点 | Knowledge Point | 视频中的最小学习单元 |
| 疑难点 | Difficult Point | 学习者理解困难的知识点 |
| 补偿资源 | Compensation Resource | 针对疑难点推送的学习资源 |
| 学习路径 | Learning Path | 个性化的学习序列 |
| 行为事件 | Watch Event | 观看视频时的行为数据 |

## 12.2 待确认问题清单（需团队讨论）

1. **首选课程与视频类型是什么？**
   - 数据库/电工/数控/编程等
   - 建议：选择一个团队熟悉的课程，便于验证

2. **知识点粒度以什么为主？**
   - 概念/技能步骤/例题
   - 建议：细粒度（如"GROUP BY执行顺序"）

3. **推送补偿是"自动弹出"还是"提示可点开"？**
   - 避免过度打扰
   - 建议：侧边栏/浮层提示（非强制）

4. **练习题自动生成是否需要教师审核？**
   - 审核流程怎么设计？
   - 建议：初版需要审核，后续可自动审核

5. **班级/个人数据展示口径与隐私边界如何定？**
   - 建议：学生只能看自己，教师只能看所教班级

6. **难点判定模型是规则-based还是ML模型？**
   - 建议：初版用规则，后续迭代ML模型

7. **补偿短视频生成路线？**
   - Sora-like模型？CogVideo？还是先用图文→视频？
   - 建议：MVP先用原视频剪辑，后续再考虑AI生成

8. **是否要做"学生主动求助"按钮？**
   - 老师倾向弱化
   - 建议：MVP不做，后续根据反馈决定

## 12.3 参考资源

- 蒋国伟团队前期"教学视频解析"项目经验
- 中车项目需求清单模板
- 相关技术文档与API文档

## 12.4 联系方式

- **项目组长**: 周东吴
- **技术顾问**: 蒋国伟
- **指导老师**: 王海霞

---

## 文档修订记录

| 版本 | 日期 | 修订人 | 修订内容 |
|------|------|--------|----------|
| v1.0 | 2024-01 | 团队 | 第一稿：基础功能模块 |
| v2.0 | 2024-01 | 团队 | 第二稿：明确优先级与核心目标 |
| v3.0 | 2024-01 | 团队 | 第三稿：细化功能设计与数据模型 |
| v4.0 | 2024-01 | 团队 | 第四稿：详细版，补充完整内容 |

---

**文档结束**